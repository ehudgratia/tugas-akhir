# library untuk manipulasi data tanggal
library(lubridate)
# library untuk menampilkan hasil statistik deskriptif
library(summarytools)
# library untuk visualisasi data
library (ggplot2)
#Mengabungkan visualisasi
library(gridExtra)
# library untuk membaca data dari file Excel (.xlsx)
library(readxl)
library(caret)
#PCA
library(FactoMineR)
#visualisasi PCA
library(factoextra)
#Correlation Matrix
library(corrplot)
# Visualisasi Correlation Matrix
library(ggcorrplot)
library(ranger)
library(randomForest)
library(pROC)
library(boot)
library(caTools)
library(e1071)
stunting <- read_excel("Dataset/stunting.xlsx")
stunting
# Library yang berisi kumpulan packages untuk analisis data
library(tidyverse)
# library untuk manipulasi data
library(dplyr)
# library untuk manipulasi data tanggal
library(lubridate)
# library untuk menampilkan hasil statistik deskriptif
library(summarytools)
# library untuk visualisasi data
library (ggplot2)
#Mengabungkan visualisasi
library(gridExtra)
# library untuk membaca data dari file Excel (.xlsx)
library(readxl)
library(caret)
#PCA
library(FactoMineR)
#visualisasi PCA
library(factoextra)
#Correlation Matrix
library(corrplot)
# Visualisasi Correlation Matrix
library(ggcorrplot)
library(ranger)
library(randomForest)
library(pROC)
library(boot)
library(caTools)
library(e1071)
stunting <- read_excel("Dataset/stunting.xlsx")
stunting
#Menampilkan struktur data
glimpse(stunting)
# Melakukan Kelas Biner Terhadap Variabel Kategorial
data_transform <- stunting %>%
mutate(umur_balita = case_when(umur_balita == "0-23 bulan" ~ 0, umur_balita == "0-59 bulan" ~ 1,),
tinggi_balita = case_when(tinggi_balita == "Sangat Pendek" ~ 0, tinggi_balita == "Pendek" ~ 1,),
status_gizi = case_when(status_gizi == "Gizi Buruk" ~ 0, status_gizi == "Gizi Kurang" ~ 1,),
daerah = case_when(daerah == "Perkotaan" ~ 0, daerah == "Perdesaan" ~ 1,),
jenis_gdp = case_when(jenis_gdp == "Harga berlaku" ~ 0, jenis_gdp == "Harga konstan 2010" ~ 1,),
status_idm = case_when(status_idm == "Sangat Tertinggal" ~ 0, status_idm == "Tertinggal" ~ 1,
status_idm == "Berkembang" ~ 2, status_idm == "Maju" ~ 3, status_idm == "Mandiri" ~ 4,))
# Mengubah variabel persentase stunting menjadi biner (0 = rendah, 1 = tinggi) dari nilai median
median_stunting <- median(stunting$persentase_stunting, na.rm = TRUE)
data_transform <- data_transform %>%
mutate(persentase_stunting = ifelse(persentase_stunting > median_stunting, 1, 0))
glimpse(data_transform)
# Menampilkan jumlah data missing value
colSums(is.na(data_transform))
# Hapus data NA's
data_clean <- na.omit(data_transform)
colSums(is.na(data_clean))
#Melakukan analisis deskripsi
descr(data_clean)
# Histogram - Distribusi jumlah balita
p1 <- ggplot(data_clean, aes(x = jumlah_balita)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data Jumlah Balita",
x = "Jumlah Balita",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi jumlah balita
p2 <- ggplot(data_clean, aes(x = jumlah_balita)) +
geom_boxplot() +
labs(title = "Boxplot Jumlah Balita",
x = "Jumlah Balita",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$jumlah_balita <- log1p(data_clean$jumlah_balita)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p3 <- ggplot(data_clean, aes(x = jumlah_balita)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data Jumlah Balita\n(Log Transformasi)",
x = "Log(Jumlah Balita)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p4 <- ggplot(data_clean, aes(x = jumlah_balita)) +
geom_boxplot() +
labs(title = "Boxplot Jumlah Balita\n(Log Transformasi)",
x = "Log(Jumlah Balita)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p1, p2, ncol = 2)
grid.arrange(p3, p4, ncol = 2)
# Histogram - Distribusi Perentase Tinggi Balita
p5 <- ggplot(data_clean, aes(x = persentase_tinggi_balita)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data\nPersentase Tinggi Balita",
x = "Persentase Tinggi Balita",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi Persentase Tinggi Balita
p6 <- ggplot(data_clean, aes(x = persentase_tinggi_balita)) +
geom_boxplot() +
labs(title = "Boxplot Persentase Tinggi Balita",
x = "Persentase Tinggi Balita",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$persentase_tinggi_balita <- log1p(data_clean$persentase_tinggi_balita)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p7 <- ggplot(data_clean, aes(x = persentase_tinggi_balita)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data\nPersentase Tinggi Balita\n(Log Transformasi)",
x = "Log(Persentase Tinggi Balita)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p8 <- ggplot(data_clean, aes(x = persentase_tinggi_balita)) +
geom_boxplot() +
labs(title = "Boxplot\nPersentase Tinggi Balita\n(Log Transformasi)",
x = "Log(Persentase Tinggi Balita)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p5, p6, ncol = 2)
grid.arrange(p7, p8, ncol = 2)
# Histogram - Distribusi Perentase Gizi
p9 <- ggplot(data_clean, aes(x = persentase_gizi)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data Persentase Gizi",
x = "Persentase Gizi",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi Persentase Gizi
p10 <- ggplot(data_clean, aes(x = persentase_gizi)) +
geom_boxplot() +
labs(title = "Boxplot Persentase Gizi",
x = "Persentase Gizi",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$persentase_gizi <- log1p(data_clean$persentase_gizi)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p11 <- ggplot(data_clean, aes(x = persentase_gizi)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data\nPersentase Gizi\n(Log Transformasi)",
x = "Log(Persentase Gizi)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p12 <- ggplot(data_clean, aes(x = persentase_gizi)) +
geom_boxplot() +
labs(title = "Boxplot\nPersentase Gizi\n(Log Transformasi)",
x = "Log(Persentase Gizi)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p9, p10, ncol = 2)
grid.arrange(p11, p12, ncol = 2)
# Histogram - Distribusi Perentase Penduduk Miskin
p13 <- ggplot(data_clean, aes(x = persentase_penduduk_miskin)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data\nPersentase Penduduk Miskin",
x = "Persentase Penduduk Miskin",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi Persentase Penduduk Miskin
p14 <- ggplot(data_clean, aes(x = persentase_penduduk_miskin)) +
geom_boxplot() +
labs(title = "Boxplot\nPersentase Penduduk Miskin",
x = "Persentase Penduduk Miskin",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$persentase_penduduk_miskin <- log1p(data_clean$persentase_penduduk_miskin)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p15 <- ggplot(data_clean, aes(x = persentase_penduduk_miskin)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data\nPersentase Penduduk Miskin\n(Log Transformasi)",
x = "Log(Persentase Penduduk Miskin)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p16 <- ggplot(data_clean, aes(x = persentase_penduduk_miskin)) +
geom_boxplot() +
labs(title = "Boxplot\nPersentase Penduduk Miskin\n(Log Transformasi)",
x = "Log(Persentase Penduduk Miskin)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p13, p14, ncol = 2)
grid.arrange(p15, p16, ncol = 2)
# Histogram - Distribusi IPM
p17 <- ggplot(data_clean, aes(x = ipm)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data IPM",
x = "IPM",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi IPM
p18 <- ggplot(data_clean, aes(x = ipm)) +
geom_boxplot() +
labs(title = "Boxplot IPM",
x = "IPM",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$ipm <- log1p(data_clean$ipm)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p19 <- ggplot(data_clean, aes(x = ipm)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data IPM \n(Log Transformasi)",
x = "Log(IPM)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p20 <- ggplot(data_clean, aes(x = ipm)) +
geom_boxplot() +
labs(title = "Boxplot IPM \n(Log Transformasi)",
x = "Log(IPM)",
y = "Frekuensi") +
theme_minimal()
##Deteksi Outlier pada Jumlah Balita
Q1 <- quantile(data_clean$ipm, 0.25)
Q3 <- quantile(data_clean$ipm, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
repeat {
Q1 <- quantile(data_clean$ipm, 0.25, na.rm = TRUE)
Q3 <- quantile(data_clean$ipm, 0.75, na.rm = TRUE)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
# Simpan jumlah data sebelum filtering
n_before <- nrow(data_clean)
# Hapus outlier langsung dari data_clean tanpa membuat dataset baru
data_clean <- data_clean[data_clean$ipm >= lower_bound & data_clean$ipm <= upper_bound, ]
# Cek jika jumlah data tidak berubah, maka keluar dari loop
if (nrow(data_clean) == n_before) break
}
##Menghapus outlier
data_clean <- data_clean[data_clean$ipm >= lower_bound & data_clean$ipm <= upper_bound, ]
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p21 <- ggplot(data_clean, aes(x = ipm)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data IPM\n(Interquartile Range (IQR))",
x = "IPM",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p22 <- ggplot(data_clean, aes(x = ipm)) +
geom_boxplot() +
labs(title = "Boxplot IPM\n(Interquartile Range (IQR))",
x = "IPM",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p17, p18, ncol = 2)
grid.arrange(p19, p20, ncol = 2)
grid.arrange(p21, p22, ncol = 2)
# Histogram - Distribusi GDP
p23 <- ggplot(data_clean, aes(x = nilai_gdp)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data GDP",
x = "GDP",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi GDP
p24 <- ggplot(data_clean, aes(x = nilai_gdp)) +
geom_boxplot() +
labs(title = "Boxplot GDP",
x = "GDP",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$nilai_gdp <- log1p(data_clean$nilai_gdp)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p25 <- ggplot(data_clean, aes(x = nilai_gdp)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data GDP\n(Log Transformasi)",
x = "Log(GDP)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p26 <- ggplot(data_clean, aes(x = nilai_gdp)) +
geom_boxplot() +
labs(title = "Boxplot GDP\n(Log Transformasi)",
x = "Log(GDP)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p23, p24, ncol = 2)
grid.arrange(p25, p26, ncol = 2)
# Histogram - Distribusi Upah
p27 <- ggplot(data_clean, aes(x = upah)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data Upah",
x = "Upah",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi Upah
p28 <- ggplot(data_clean, aes(x = upah)) +
geom_boxplot() +
labs(title = "Boxplot Upah",
x = "Upah",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p27, p28, ncol = 2)
# Histogram - Distribusi IDM
p29 <- ggplot(data_clean, aes(x = idm)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data IDM",
x = "IDM",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Distribusi IDM
p30 <- ggplot(data_clean, aes(x = idm)) +
geom_boxplot() +
labs(title = "Boxplot IDM",
x = "IDM",
y = "Frekuensi") +
theme_minimal()
# Log Transformasi untuk membuat distribusi lebih seimbang
data_clean$idm <- log1p(data_clean$idm)  # log1p untuk menangani nol
# Histogram - Visualisasi Distribusi Data setelah Transformasi Log
p31 <- ggplot(data_clean, aes(x = idm)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.6) +
labs(title = "Distribusi Data IDM\n(Log Transformasi)",
x = "Log(IDM)",
y = "Frekuensi") +
theme_minimal()
# Boxplot - Visualisasi Distribusi Data setelah Transformasi Log
p32 <- ggplot(data_clean, aes(x = idm)) +
geom_boxplot() +
labs(title = "Boxplot IDM\n(Log Transformasi)",
x = "Log(IDM)",
y = "Frekuensi") +
theme_minimal()
grid.arrange(p29, p30, ncol = 2)
grid.arrange(p31, p32, ncol = 2)
target <- data_clean$persentase_stunting
feature <- data_clean[, !names(data_clean) %in% "persentase_stunting"]
# Correlation Matrix
## Pilih hanya variabel numerik
feature_numeric <- feature %>%
select(where(is.numeric)) %>%
select(-tahun)  # Exclude the year column
## Hitung matriks korelasi sebelum penghapusan
cor_matrix_before <- cor(feature_numeric, use = "pairwise.complete.obs", method = "pearson")
## Temukan fitur yang memiliki korelasi tinggi (|r| > 0.75)
high_cor <- findCorrelation(cor_matrix_before, cutoff = 0.75, names = FALSE)
## Hapus fitur yang memiliki korelasi tinggi
feature_filtered <- feature_numeric %>% select(-all_of(names(feature_numeric)[high_cor]))
## Hitung kembali matriks korelasi setelah penghapusan
cor_matrix_after <- cor(feature_filtered, use = "pairwise.complete.obs", method = "pearson")
## Plot Sebelum Penghapusan (Seperti Gambar yang Anda Unggah)
ggcorrplot(cor_matrix_before,
type = "lower",        # Hanya setengah bagian bawah
lab = TRUE,            # Menampilkan nilai korelasi
lab_size = 3,          # Ukuran teks
colors = c("red", "white", "blue"),  # Skala warna (Merah - Putih - Biru)
title = "Matriks Korelasi Sebelum Penghapusan",
show.legend = TRUE,
ggtheme = ggplot2::theme_minimal())
## Plot Setelah Penghapusan (Untuk Perbandingan)
ggcorrplot(cor_matrix_after,
type = "lower",
lab = TRUE,
lab_size = 3,
colors = c("red", "white", "blue"),
title = "Matriks Korelasi Setelah Penghapusan",
show.legend = TRUE,
ggtheme = ggplot2::theme_minimal())
# Recursive Feature Elimination (RFE)
## memilih fitur terbaik
set.seed(123)
# Kontrol untuk RFE
control <- rfeControl(functions = rfFuncs, method = "cv", number = 10)
# Jalankan Recursive Feature Elimination
rfe_result <- rfe(feature_filtered, target, sizes = c(1:10), rfeControl = control)
rfe_result
# Principal Component Analysis (PCA)
## Mengambil nama fitur terbaik
selected_features <- predictors(rfe_result)
## Data frame hanya dengan fitur yang dipilih
features_selected <- feature_filtered[, selected_features]
## Pre-Processing Data
rfe_pre <- preProcess(features_selected, method = c("center", "scale"))
## Normalisasi
rfe_scaled <- predict(rfe_pre, features_selected)
## Cek ringkasan data setelah standarisasi
summary(rfe_scaled)
## Jalankan PCA dengan data yang telah distandarisasi
pca_result <- PCA(rfe_scaled, graph = FALSE)
## Lihat ringkasan PCA
summary(pca_result)
## Melacak kontribusi variabel
pca_result$var$contrib
## Jumlah komponen utama yang optimal untuk analisis
fviz_eig(pca_result, addlabels = TRUE, ylim = c(0, 100))
## Membuat peta factor untuk kontribusi variabel
fviz_pca_var(pca_result, col.var = "contrib", gradient.cols = c("#002bbb", "#bb2e00"), repel = TRUE)
## Visualisasi kontribusi dari variabel
fviz_contrib(pca_result, choice = "var", axes = 1, top = 5)
## Visualisasi untuk semua hubungan antar variabel
fviz_pca_biplot(pca_result)
# Menggabungkan variabel feature dengan variabel target
final_data <- cbind(features_selected, stunting = target)
#Visualisasi Distrubusi Stunting
ggplot(final_data, aes(x = as.factor(stunting))) +
geom_bar(fill = "blue") +
labs(title = "Distribusi Data Stunting",
x = "Stunting",
y = "Frekuensi") +
theme_minimal
# Library yang berisi kumpulan packages untuk analisis data
library(tidyverse)
# library untuk manipulasi data
library(dplyr)
# library untuk manipulasi data tanggal
library(lubridate)
# library untuk menampilkan hasil statistik deskriptif
library(summarytools)
# library untuk visualisasi data
library (ggplot2)
#Mengabungkan visualisasi
library(gridExtra)
# library untuk membaca data dari file Excel (.xlsx)
library(readxl)
library(caret)
#PCA
library(FactoMineR)
#visualisasi PCA
library(factoextra)
#Correlation Matrix
library(corrplot)
# Visualisasi Correlation Matrix
library(ggcorrplot)
library(ranger)
library(randomForest)
library(pROC)
library(boot)
library(caTools)
library(e1071)
rfe_result
set.seed(123)  # Untuk hasil yang dapat direproduksi
data_index <- createDataPartition(final_data$stunting, p = 0.7, list = FALSE)
data_train <- final_data[data_index, ]
data_test <- final_data[-data_index, ]
data_train
data_test
data_train$stunting <- as.numeric(as.character(data_train$stunting))
# Fungsi untuk menghitung statistik (misalnya, rata-rata dari variabel tertentu)
boot_function <- function(data, indices) {
sample_data <- data[indices, ]  # Ambil sampel bootstrap
return(mean(sample_data$stunting))  # Estimasi rata-rata stunting
}
# Lakukan bootstrap sampling sebanyak 1000 kali
set.seed(123)
boot_result <- boot(data_train, statistic = boot_function, R = 1000)
# Plot distribusi hasil bootstrap
hist(boot_result$t, col = "blue", main = "Distribusi Bootstrap Mean Stunting", xlab = "Mean Stunting")
# menghitung interval kepercayaan
quantile(boot_result$t, probs = c(0.025, 0.975))
# mengubah variabel target menjadi faktor
data_train$stunting <- as.factor(data_train$stunting)
data_test$stunting <- as.factor(data_test$stunting)
# Membangun Model RF
set.seed(123) #Set seed untuk hasil yang reproducible
rf_model <- randomForest(stunting ~ ., data = data_train, importance = TRUE)
# Print hasil model
print(rf_model)
# Prediksi
pred_train <- predict(rf_model, newdata = data_train, type = "class")
pred_test  <- predict(rf_model, newdata = data_test, type = "class")
# Evaluasi model pada training data
conf_matrix_train <- confusionMatrix(pred_train, data_train$stunting)
print(conf_matrix_train)
# Evaluasi model pada test data
conf_matrix_test <- confusionMatrix(pred_test, data_test$stunting)
print(conf_matrix_test)
# Menampilkan metrik tambahan untuk test data
cat("Akurasi pada data test:", conf_matrix_test$overall["Accuracy"], "\n")
cat("Recall pada data test:", conf_matrix_test$byClass["Sensitivity"], "\n")
cat("Precision pada data test:", conf_matrix_test$byClass["Precision"], "\n")
cat("F1-score pada data test:", conf_matrix_test$byClass["F1"], "\n")
# Melakukan Prediksi
pred_test  <- predict(rf_model, newdata = data_test, type = "class")
# Evaluasi model pada test data
conf_matrix_test <- confusionMatrix(pred_test, data_test$stunting)
conf_matrix_test
# Menampilkan metrik tambahan untuk test data
cat("Akurasi pada data test:", conf_matrix_test$overall["Accuracy"], "\n")
cat("Recall pada data test:", conf_matrix_test$byClass["Sensitivity"], "\n")
cat("Precision pada data test:", conf_matrix_test$byClass["Precision"], "\n")
cat("F1-score pada data test:", conf_matrix_test$byClass["F1"], "\n")
